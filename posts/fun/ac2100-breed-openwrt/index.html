<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>小米 AC2100 刷入 Breed 和 Openwrt 小记 | Zhiwen's Blog</title><meta name=keywords content="AC2100 Breed Openwrt"><meta name=description content="以前用家里闲置的笔记本玩过 lean 的软路由，但是需要电脑一直开着，不适合长期使用，所以我一直希望有一台真正可以刷入相关固件的路由器。相比网件、华硕等路由器，我简单的需求更适合 200 元左右的小米 AC2100。"><meta name=author content="Zhiwen Liang"><link rel=canonical href=https://zhiwenliang.github.io/posts/fun/ac2100-breed-openwrt/><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://zhiwenliang.github.io/logo/favicon-16x16.png><link rel=icon type=image/png sizes=16x16 href=https://zhiwenliang.github.io/logo/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://zhiwenliang.github.io/logo/favicon-32x32.png><link rel=apple-touch-icon href=https://zhiwenliang.github.io/logo/apple-touch-icon.png><link rel=mask-icon href=https://zhiwenliang.github.io/logo/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.94.2"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="小米 AC2100 刷入 Breed 和 Openwrt 小记"><meta property="og:description" content="以前用家里闲置的笔记本玩过 lean 的软路由，但是需要电脑一直开着，不适合长期使用，所以我一直希望有一台真正可以刷入相关固件的路由器。相比网件、华硕等路由器，我简单的需求更适合 200 元左右的小米 AC2100。"><meta property="og:type" content="article"><meta property="og:url" content="https://zhiwenliang.github.io/posts/fun/ac2100-breed-openwrt/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-11-08T09:20:46+08:00"><meta property="article:modified_time" content="2021-11-08T09:20:46+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="小米 AC2100 刷入 Breed 和 Openwrt 小记"><meta name=twitter:description content="以前用家里闲置的笔记本玩过 lean 的软路由，但是需要电脑一直开着，不适合长期使用，所以我一直希望有一台真正可以刷入相关固件的路由器。相比网件、华硕等路由器，我简单的需求更适合 200 元左右的小米 AC2100。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://zhiwenliang.github.io/posts/"},{"@type":"ListItem","position":3,"name":"小米 AC2100 刷入 Breed 和 Openwrt 小记","item":"https://zhiwenliang.github.io/posts/fun/ac2100-breed-openwrt/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"小米 AC2100 刷入 Breed 和 Openwrt 小记","name":"小米 AC2100 刷入 Breed 和 Openwrt 小记","description":"以前用家里闲置的笔记本玩过 lean 的软路由，但是需要电脑一直开着，不适合长期使用，所以我一直希望有一台真正可以刷入相关固件的路由器。相比网件、华硕等路由器，我简单的需求更适合 200 元左右的小米 AC2100。\n","keywords":["AC2100 Breed Openwrt"],"articleBody":"以前用家里闲置的笔记本玩过 lean 的软路由，但是需要电脑一直开着，不适合长期使用，所以我一直希望有一台真正可以刷入相关固件的路由器。相比网件、华硕等路由器，我简单的需求更适合 200 元左右的小米 AC2100。\n如何刷机 现在的刷机途径大致有 2 个：\n 利用之前爆出的 CVE-2020-8597 漏洞开启 telnet 和 ssh 刷入 breed 或者 pb-boot，然后刷入想要的固件。 利用固件的 SSH 相关漏洞打开 SSH，然后刷入 breed 或者 pb-boot。  由于第一种方法需要较多的额外工具，我选择了第二种方法。\n刷入的固件也可以选择 pandvas 或者 Openwrt，现在 Openwrt 已经官方支持了 AC2100，所以刷入相关系统也是方便很多的。\n开启 ssh   电脑网口连接 Lan 口，浏览器打开 小米 AC2100 web 管理页面 ，简单设置后登录。\n  在登录后的页面 F12 打开网页后台，在控制台（Console）复制粘贴如下代码，Enter 执行。\n  function getSTOK() {  let match = location.href.match(/;stok=(.*?)\\//);  if (!match) {  return null;  }  return match[1]; }  function execute(stok, command) {  command = encodeURIComponent(command);  let path = `/cgi-bin/luci/;stok=${stok}/api/misystem/set_config_iotdev?bssid=SteelyWing\u0026user_id=SteelyWing\u0026ssid=-h%0A${command}%0A`;  console.log(path);  return fetch(new Request(location.origin + path)); }  function enableSSH() {  stok = getSTOK();  if (!stok) {  console.error(\"stok not found in URL\");  return;  }  console.log(`stok = \"${stok}\"`);   password = prompt(\"Input new SSH password\");  if (!password) {  console.error(\"You must input password\");  return;  }   execute(  stok,  ` nvram set ssh_en=1 nvram commit sed -i 's/channel=.*/channel=\\\\\"debug\\\\\"/g' /etc/init.d/dropbear /etc/init.d/dropbear start `  )  .then((response) = response.text())  .then((text) = console.log(text));  console.log(\"New SSH password: \" + password);  execute(stok, `echo -e \"${password}\\\\n${password}\" | passwd root`)  .then((response) = response.text())  .then((text) = console.log(text)); }  enableSSH(); 在网页上会弹出设置 root 账户密码的弹窗，设置后关闭。\n至此已经成功打开 SSH。\n上传固件并刷入 Breed 并设置  在本机命令行通过 ssh 登录路由器系统，账户为 root，密码即刚刚设置的。192.168.31.1 是路由器的默认内网 ip 地址。  ssh root@192.168.31.1 将本机的 breed 固件传输到 /tmp 目录下，执行如下命令：  nvram set uart_en=1 nvram set bootdelay=5 nvram set flag_try_sys1_failed=1 nvram commit mtd -r write [上传到tmp目录的固件地址] kernel1 如果路由器在 60 秒内重启则代表刷 BREED 成功(灯会从蓝变橘，最终变蓝进入系统)。成功后拔掉电源，按住 reset 同时接上电源等 10 秒即可。\n最后，浏览器打开 breed web 管理页面，刷入 Breed 成功。  通过 Breed 刷入 Openwrt  进入 breed 后增加环境变量 xiaomi.r3g.bootfw，值为 2。 在固件项选择对应的底包，然后上传刷入，后面按照对应固件的提示操作即可  刷砖后恢复小米原厂系统 由于过程中随时存在刷砖的风险，所以去 官方下载页 可以下载使用对应的官方工具刷入官方的 rom 然后重头再来。\nReference  永久开启小米/红米 AC2100 TELNET 和 SSH，可升级、降级和恢复出厂 AX3600/AX1800/AX5/AC2100 官方固件开启 SSH 方法 AC2100 OpenWrt Guide 小米 红米【AC2100】一键刷 BREED【30 秒刷完】小白帅小伙专用 检查坏块 | 无需 Telnet breed 刷机红米 AC2100 小米 AC2100 原厂固件官方固 红米 AC2100 刷机及固件资源汇总附送 Lean 源码固件 红米/小米 AC2100 刷入 r3g breed 以及恢复官方 boot 详细教程 [AC2100(RM2100)] lienol源码主分支 红米AC2100固件 openwrt21.02 ipv6+文件助手+去广告+简洁主题 ","wordCount":"274","inLanguage":"en","datePublished":"2021-11-08T09:20:46+08:00","dateModified":"2021-11-08T09:20:46+08:00","author":{"@type":"Person","name":"Zhiwen Liang"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhiwenliang.github.io/posts/fun/ac2100-breed-openwrt/"},"publisher":{"@type":"Organization","name":"Zhiwen's Blog","logo":{"@type":"ImageObject","url":"https://zhiwenliang.github.io/logo/favicon-16x16.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://zhiwenliang.github.io accesskey=h title="Zhiwen's Blog (Alt + H)">Zhiwen's Blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://zhiwenliang.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://zhiwenliang.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://zhiwenliang.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://zhiwenliang.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://zhiwenliang.github.io/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://zhiwenliang.github.io>Home</a>&nbsp;»&nbsp;<a href=https://zhiwenliang.github.io/posts/>Posts</a></div><h1 class=post-title>小米 AC2100 刷入 Breed 和 Openwrt 小记</h1><div class=post-meta><span title="2021-11-08 09:20:46 +0800 +0800">November 8, 2021</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Zhiwen Liang&nbsp;|&nbsp;<a href="mailto:zhiwen_liang@outlook.com?subject=Suggesting%20changes%20for%20/posts/fun/ac2100-breed-openwrt.md" rel="noopener noreferrer" target=_blank>Suggest</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%a6%82%e4%bd%95%e5%88%b7%e6%9c%ba aria-label=如何刷机>如何刷机</a></li><li><a href=#%e5%bc%80%e5%90%af-ssh aria-label="开启 ssh">开启 ssh</a></li><li><a href=#%e4%b8%8a%e4%bc%a0%e5%9b%ba%e4%bb%b6%e5%b9%b6%e5%88%b7%e5%85%a5-breed-%e5%b9%b6%e8%ae%be%e7%bd%ae aria-label="上传固件并刷入 Breed 并设置">上传固件并刷入 Breed 并设置</a></li><li><a href=#%e9%80%9a%e8%bf%87-breed-%e5%88%b7%e5%85%a5-openwrt aria-label="通过 Breed 刷入 Openwrt">通过 Breed 刷入 Openwrt</a></li><li><a href=#%e5%88%b7%e7%a0%96%e5%90%8e%e6%81%a2%e5%a4%8d%e5%b0%8f%e7%b1%b3%e5%8e%9f%e5%8e%82%e7%b3%bb%e7%bb%9f aria-label=刷砖后恢复小米原厂系统>刷砖后恢复小米原厂系统</a></li><li><a href=#reference aria-label=Reference>Reference</a></li></ul></div></details></div><div class=post-content><p>以前用家里闲置的笔记本玩过 lean 的软路由，但是需要电脑一直开着，不适合长期使用，所以我一直希望有一台真正可以刷入相关固件的路由器。相比网件、华硕等路由器，我简单的需求更适合 200 元左右的小米 AC2100。</p><h2 id=如何刷机>如何刷机<a hidden class=anchor aria-hidden=true href=#如何刷机>#</a></h2><p>现在的刷机途径大致有 2 个：</p><ol><li>利用之前爆出的 CVE-2020-8597 漏洞开启 telnet 和 ssh 刷入 breed 或者 pb-boot，然后刷入想要的固件。</li><li>利用固件的 SSH 相关漏洞打开 SSH，然后刷入 breed 或者 pb-boot。</li></ol><p>由于第一种方法需要较多的额外工具，我选择了第二种方法。</p><p>刷入的固件也可以选择 pandvas 或者 Openwrt，现在 Openwrt 已经官方支持了 AC2100，所以刷入相关系统也是方便很多的。</p><h2 id=开启-ssh>开启 ssh<a hidden class=anchor aria-hidden=true href=#开启-ssh>#</a></h2><ol><li><p>电脑网口连接 Lan 口，浏览器打开 <a href=https://miwifi.com>小米 AC2100 web 管理页面</a> ，简单设置后登录。</p></li><li><p>在登录后的页面 F12 打开网页后台，在控制台（Console）复制粘贴如下代码，Enter 执行。</p></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JavaScript data-lang=JavaScript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getSTOK</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>match</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>location</span>.<span style=color:#a6e22e>href</span>.<span style=color:#a6e22e>match</span>(<span style=color:#e6db74>/;stok=(.*?)\//</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>match</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>match</span>[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>execute</span>(<span style=color:#a6e22e>stok</span>, <span style=color:#a6e22e>command</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>command</span> <span style=color:#f92672>=</span> encodeURIComponent(<span style=color:#a6e22e>command</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>path</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`/cgi-bin/luci/;stok=</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>stok</span><span style=color:#e6db74>}</span><span style=color:#e6db74>/api/misystem/set_config_iotdev?bssid=SteelyWing&amp;user_id=SteelyWing&amp;ssid=-h%0A</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>command</span><span style=color:#e6db74>}</span><span style=color:#e6db74>%0A`</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>path</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>fetch</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Request</span>(<span style=color:#a6e22e>location</span>.<span style=color:#a6e22e>origin</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>path</span>));
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>enableSSH</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>stok</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>getSTOK</span>();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>stok</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#34;stok not found in URL&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`stok = &#34;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>stok</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;`</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>password</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>prompt</span>(<span style=color:#e6db74>&#34;Input new SSH password&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>password</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#34;You must input password&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>execute</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>stok</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>nvram set ssh_en=1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>nvram commit
</span></span></span><span style=display:flex><span><span style=color:#e6db74>sed -i &#39;s/channel=.*/channel=\\&#34;debug\\&#34;/g&#39; /etc/init.d/dropbear
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/etc/init.d/dropbear start
</span></span></span><span style=display:flex><span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>then</span>((<span style=color:#a6e22e>response</span>) =&gt; <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>text</span>())
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>then</span>((<span style=color:#a6e22e>text</span>) =&gt; <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>text</span>));
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;New SSH password: &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>password</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>execute</span>(<span style=color:#a6e22e>stok</span>, <span style=color:#e6db74>`echo -e &#34;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>password</span><span style=color:#e6db74>}</span><span style=color:#e6db74>\\n</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>password</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34; | passwd root`</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>then</span>((<span style=color:#a6e22e>response</span>) =&gt; <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>text</span>())
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>then</span>((<span style=color:#a6e22e>text</span>) =&gt; <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>text</span>));
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>enableSSH</span>();
</span></span></code></pre></div><p>在网页上会弹出设置 root 账户密码的弹窗，设置后关闭。</p><p>至此已经成功打开 SSH。</p><h2 id=上传固件并刷入-breed-并设置>上传固件并刷入 Breed 并设置<a hidden class=anchor aria-hidden=true href=#上传固件并刷入-breed-并设置>#</a></h2><ol><li>在本机命令行通过 ssh 登录路由器系统，账户为 root，密码即刚刚设置的。<code>192.168.31.1</code> 是路由器的默认内网 ip 地址。</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh root@192.168.31.1
</span></span></code></pre></div><ol start=2><li>将本机的 breed 固件传输到 <code>/tmp</code> 目录下，执行如下命令：</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nvram set uart_en<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>nvram set bootdelay<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>nvram set flag_try_sys1_failed<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>nvram commit
</span></span><span style=display:flex><span>mtd -r write <span style=color:#f92672>[</span>上传到tmp目录的固件地址<span style=color:#f92672>]</span> kernel1
</span></span></code></pre></div><p>如果路由器在 60 秒内重启则代表刷 BREED 成功(灯会从蓝变橘，最终变蓝进入系统)。成功后拔掉电源，按住 reset 同时接上电源等 10 秒即可。</p><ol start=3><li>最后，浏览器打开 <a href=192.168.1.1>breed web 管理页面</a>，刷入 Breed 成功。</li></ol><h2 id=通过-breed-刷入-openwrt>通过 Breed 刷入 Openwrt<a hidden class=anchor aria-hidden=true href=#通过-breed-刷入-openwrt>#</a></h2><ol><li>进入 breed 后增加环境变量 xiaomi.r3g.bootfw，值为 2。</li><li>在固件项选择对应的底包，然后上传刷入，后面按照对应固件的提示操作即可</li></ol><h2 id=刷砖后恢复小米原厂系统>刷砖后恢复小米原厂系统<a hidden class=anchor aria-hidden=true href=#刷砖后恢复小米原厂系统>#</a></h2><p>由于过程中随时存在刷砖的风险，所以去 <a href=http://miwifi.com/miwifi_download.html>官方下载页</a> 可以下载使用对应的官方工具刷入官方的 rom 然后重头再来。</p><h2 id=reference>Reference<a hidden class=anchor aria-hidden=true href=#reference>#</a></h2><ol><li><a href=https://www.right.com.cn/forum/thread-4056385-1-1.html>永久开启小米/红米 AC2100 TELNET 和 SSH，可升级、降级和恢复出厂</a></li><li><a href=https://www.right.com.cn/forum/thread-4032490-1-1.html>AX3600/AX1800/AX5/AC2100 官方固件开启 SSH 方法</a></li><li><a href=https://github.com/ecklf/ac2100-openwrt-guide>AC2100 OpenWrt Guide</a></li><li><a href=https://www.right.com.cn/forum/thread-4066963-1-1.html>小米 红米【AC2100】一键刷 BREED【30 秒刷完】小白帅小伙专用 检查坏块 | 无需 Telnet</a></li><li><a href=https://www.right.com.cn/forum/thread-4028850-1-1.html>breed 刷机红米 AC2100 小米 AC2100 原厂固件官方固</a></li><li><a href=https://www.right.com.cn/forum/thread-4021018-1-1.html>红米 AC2100 刷机及固件资源汇总附送 Lean 源码固件</a></li><li><a href="https://www.right.com.cn/forum/forum.php?mod=viewthread&tid=4023907&extra=page%3D1%26filter%3Dtypeid%26typeid%3D43">红米/小米 AC2100 刷入 r3g breed 以及恢复官方 boot 详细教程</a></li><li><a href="https://www.right.com.cn/forum/forum.php?mod=viewthread&tid=5852382&extra=page%3D1%26filter%3Ddigest%26digest%3D1">[AC2100(RM2100)] lienol源码主分支 红米AC2100固件 openwrt21.02 ipv6+文件助手+去广告+简洁主题</a></li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://zhiwenliang.github.io/tags/ac2100-breed-openwrt/>AC2100 Breed Openwrt</a></li></ul><nav class=paginav><a class=next href=https://zhiwenliang.github.io/posts/cs/cap-and-base/><span class=title>Next Page »</span><br><span>CAP 和 BASE 理论</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://zhiwenliang.github.io>Zhiwen's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>